## 循序的大腦

大多數人都曾經聽某個人說過 ( 甚至你自己就曾這麼說 )，"我能一心多用"。試圖表現得一心多用的效果包含幽默 ( 孩子們的拍頭揉肚子遊戲 )，平常的行為 ( 邊走邊嚼口香糖 )，和徹頭徹尾的危險 ( 開車時發微信 )。

然而實際上並不是如此，當我們模擬一心多用時，其實只是不停地在兩個行程之間切換，這就像是非同步的行為!!!

### 執行 VS 規劃

我們的大腦在規劃事情時，總是用同步的思考來進行規劃，想像再來你要做的事情 : "我得去商店，然後買些牛奶，然後去乾洗店"，注意這邊的思考完全的是以同步的方式來進行思考，中間出現的非同步請求我們可以輕鬆地解決它，然而在撰寫程式時，我們會小心翼翼地規劃所有的事情，想像一下你有辦法這樣安排事情嗎 ? 

"我得去趟商店，但是我確信在路上我會接到一個電話，於是'嗨，媽媽'，然後她開始講話，我會在GPS上搜索商店的位置，但那會花幾分鐘加載，所以我把收音機音量調小以便聽到媽媽講話，然後我發現我忘了穿夾克而且外面很冷，但沒關係，繼續開車並和媽媽說話，然後安全帶警報提醒我要係好，於是'是的，媽，我係著安全帶呢，我總是繫著安全帶！'。啊，GPS終於得到方向了，現在......"

這邊是一種類比，在程式中我們總是用細細地規劃每一步應該怎麼做，而在非同步請求時也是如此，然而對於我們來說，使用 Callback 來處理非同步請求，就像是上面的例子一樣，極其不直觀也令人困惑，原因在於我們並不是那樣思考。

### 巢狀或鏈串的 Callback

``` JavaScript
listen("click", function handler(evt) {
    setTimeout(function request() {
        ajax("http://some.url.1", function response(text) {
            if (text == "hello") {
                handler();
            } else if (text == "world") {
                request();
            }
        });
    }, 500);
});
```

這段程式碼常被稱作 Callback hell，也有人稱其為毀滅金字塔，但問題與縮排並沒有很大的關係。它的順序看似沒有什麼問題，可以循序的來思考，首先是 `listen` 、再來是 `setTimeout` 、接著 `ajax` 、最後是 `if` 。


